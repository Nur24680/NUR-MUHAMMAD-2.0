const axios = require("axios");
const fs = require("fs-extra");
const path = require("path");

module.exports.config = {
  name: "mentionKing",
  version: "2.0.0",
  eventType: ["message"],
  credits: "ğŠğ¢ğ§ğ _ğ’ğ¡ğ¨ğ®ğ«ğ¨ğ¯",
  description: "ğŠğ¢ğ§ğ _ğ’ğ¡ğ¨ğ®ğ«ğ¨ğ¯ à¦•à§‡ à¦®à§‡à¦¨à¦¶à¦¨ à¦•à¦°à¦²à§‡ à¦°à§‡à¦¸à¦ªà¦¨à§à¦¸ à¦¦à§‡à¦¯à¦¼"
};

const KING_UID = "100070297030133";
const KING_FB_LINK = "https://www.facebook.com/www.xsxx.com365";

const replies = [
  "ğŸ’ à¦¬à¦¸ ğŠğ¢ğ§ğ _ğ’ğ¡ğ¨ğ®ğ«ğ¨ğ¯ à¦•à§‡ à¦¡à¦¾à¦• à¦¦à¦¿à¦›à§‹! à¦¸à¦¾à¦²à¦¾à¦® à¦¦à§‡à¦“ à¦†à¦—à§‡! ğŸ«¡",
  "ğŸ”¥ à¦¤à§‹à¦®à¦°à¦¾ à¦œà¦¾à¦¨à§‹ à¦¨à¦¾, ğŠğ¢ğ§ğ _ğ’ğ¡ğ¨ğ®ğ«ğ¨ğ¯ à¦•à§‡ mention à¦•à¦°à¦²à§‡ à¦—à§à¦°à§à¦ª à¦•à¦¾à¦à¦ªà§‡!",
  "ğŸ¥€ à¦­à¦¾à¦‡, à¦“à¦‡ à¦¯à§‡ à¦¬à¦²à¦²à¦¾à¦® à¦¨à¦¾, ğ’ğ¡ğ¨ğ®ğ«ğ¨ğ¯ à¦à¦–à¦¨ à¦˜à§à¦®à§‡!",
  "ğŸš€ à¦•à¦¿à¦‚ à¦¤à§‹ à¦à¦–à¦¨ à¦šà¦¾à¦à¦¦à§‡ à¦®à¦¿à¦¶à¦¨ à¦šà¦¾à¦²à¦¾à¦šà§à¦›à§‡, à¦ªà¦°à§‡ à¦†à¦¸à§‹!",
  "ğŸ‘‘ ğğğ’ğ’ à¦•à§‡ à¦¡à¦¾à¦• à¦¦à§‡à¦“à§Ÿà¦¾à¦° à¦†à¦—à§‡ à¦…à¦¨à§à¦®à¦¤à¦¿ à¦¨à§‡à¦“ à¦ªà§à¦°à§Ÿà§‹à¦œà¦¨!",
  "âš¡ ğŠğ¢ğ§ğ _ğ’ğ¡ğ¨ğ®ğ«ğ¨ğ¯ is offline now... Be patient!",
  "ğŸ© Legend never sleeps â€” à¦¶à§Œà¦°à¦­ à¦­à¦¾à¦‡ à¦à¦•à§à¦¸à¦ªà¦¾à¦°à§à¦Ÿ à¦®à§‹à¦¡à§‡ à¦†à¦›à§‡!",
  "ğŸ¤ à¦­à¦¾à¦‡à¦°à§‡ à¦­à¦¾à¦‡! ğŠğ¢ğ§ğ _ğ’ğ¡ğ¨ğ®ğ«ğ¨ğ¯ à¦¨à¦¾à¦® à¦¶à§à¦¨à¦²à§‡à¦‡ respect à¦†à¦¸à§‡!",
  "ğŸŒˆ à¦¤à§‹à¦° à¦à¦®à¦¨ à¦¸à¦¾à¦¹à¦¸! à¦•à¦¿à¦‚ à¦•à§‡ mention à¦•à¦°à¦¿à¦¸!",
  "ğŸ“£ à¦†à¦¬à¦¾à¦° à¦¬à¦²à¦›à¦¿... ğŠğ¢ğ§ğ _ğ’ğ¡ğ¨ğ®ğ«ğ¨ğ¯ = Legend ğŸ”¥",
  "ğŸ¤´ à¦¤à§‹à¦•à§‡ à¦¬à¦²à¦¤à§‡à¦‡ à¦¹à¦¬à§‡, 'ğ’ğ¡ğ¨ğ®ğ«ğ¨ğ¯ à¦­à¦¾à¦‡ à¦°à§‡ à¦¸à¦¾à¦²à¦¾à¦®' ğŸ˜Œ",
  "ğŸ”” à¦¶à§Œà¦°à¦­ à¦­à¦¾à¦‡ available à¦¨à¦¾... Try again later ğŸ˜´",
  "ğŸ“· à¦ªà§à¦°à§‹à¦«à¦¾à¦‡à¦² à¦¦à§‡à¦–à¦¤à§‡ à¦šà¦¾à¦“? ğŸ‘‰ " + KING_FB_LINK,
  "ğŸ’Œ à¦­à¦¾à¦‡à¦°à§‡, à¦•à¦¿à¦‚ à¦¤à§‹ à¦à¦•à§à¦¸à¦¾à¦® à¦¦à¦¿à¦šà§à¦›à§‡, à¦ªà¦°à§‡à¦“ à¦¡à¦¾à¦• à¦¦à¦¿à¦“!",
  "ğŸ•¶ï¸ à¦•à¦¿à¦‚ à¦à¦–à¦¨ 'coding zone'-à¦, disturb à¦•à¦°à¦¾ à¦®à¦¾à¦¨à¦¾!",
  "ğŸŒŸ à¦¤à§‹à¦®à¦¾à¦° à¦¸à§Œà¦­à¦¾à¦—à§à¦¯ à¦¯à§‡ à¦•à¦¿à¦‚ à¦¤à§‹à¦®à¦¾à¦° à¦®à§‡à¦¨à¦¶à¦¨ à¦¦à§‡à¦–à§‡à¦›à§‡!",
  "ğŸª„ à¦¯à§‡à¦‡ à¦¬à¦²à¦¬à¦¿ à¦•à¦¿à¦‚, à¦…à¦®à¦¨à¦¿ à¦œà¦¾à¦¦à§ à¦¶à§à¦°à§!",
  "ğŸ–ï¸ à¦•à¦¿à¦‚ à¦•à§‡ à¦®à§‡à¦¨à¦¶à¦¨ à¦®à¦¾à¦¨à§‡à¦‡ Power trigger!",
  "ğŸ•µï¸â€â™‚ï¸ à¦•à¦¿à¦‚ à¦¦à§‡à¦–à§‡à¦›à§‡, à¦•à¦¿à¦¨à§à¦¤à§ à¦•à¦¿à¦›à§ à¦¬à¦²à¦¬à§‡ à¦¨à¦¾... Royal Silence!",
  "ğŸ« à¦•à¦¿à¦‚ à¦à¦–à¦¨ Chocolate à¦–à¦¾à¦šà§à¦›à§‡, à¦¬à§à¦¯à¦¸à§à¦¤!",
  "ğŸ›¡ï¸ à¦•à¦¿à¦‚ à¦šà¦¾à¦‡à¦²à§‡à¦‡ à¦¤à§‹à¦®à¦¾à¦•à§‡ à¦—à§à¦°à§à¦ª à¦¥à§‡à¦•à§‡ à¦‰à¦ à¦¿à§Ÿà§‡ à¦¦à¦¿à¦¤à§‡ à¦ªà¦¾à¦°à§‡ ğŸ˜ˆ",
  "ğŸŒªï¸ KING à¦®à§‡à¦¨à¦¶à¦¨ à¦¹à¦²à§‡à¦‡ group à¦ à¦à§œ à¦“à¦ à§‡!",
  "ğŸ¯ à¦°à¦¿à¦¸à§à¦ªà§‡à¦•à§à¦Ÿ à¦¦à§‡ à¦•à¦¿à¦‚ à¦•à§‡! à¦¨à¦¾ à¦¹à¦²à§‡... ğŸ˜",
  "ğŸ’¬ à¦•à¦¿à¦‚ à¦¬à¦²à¦²à§‹ â€“ 'I'm watching you...' ğŸ‘€",
  "ğŸ”® à¦•à¦¿à¦‚ à¦¤à§‹ à¦à¦–à¦¨ meditation à¦ à¦¬à¦¸à§‡ à¦†à¦›à§‡... ğŸ˜Œ"
];

module.exports.run = async function ({ api, event }) {
  const mentions = event.mentions;
  if (!mentions || !Object.keys(mentions).includes(KING_UID)) return;

  try {
    const url = `https://graph.facebook.com/${KING_UID}/picture?width=512&height=512&access_token=350685531728|62f8ce9f74b12f84c123cc23437a4a32`;
    const pathImg = path.join(__dirname, "kingMention.jpg");
    const response = await axios.get(url, { responseType: "arraybuffer" });
    fs.writeFileSync(pathImg, Buffer.from(response.data, "binary"));

    const msg = {
      body: `${replies[Math.floor(Math.random() * replies.length)]}\n\nğŸ“Œ à¦ªà§à¦°à§‹à¦«à¦¾à¦‡à¦²: ${KING_FB_LINK}`,
      attachment: fs.createReadStream(pathImg)
    };

    api.sendMessage(msg, event.threadID, () => {
      fs.unlinkSync(pathImg);
    });
  } catch (err) {
    console.error("âŒ Error sending mentionKing reply:", err);
  }
};
